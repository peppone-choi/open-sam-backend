# ğŸ‰ ì™„ì „ Lore ì¤‘ë¦½ ê²Œì„ ì‹œìŠ¤í…œ ìµœì¢… ì™„ì„±

## ğŸ“Š ì „ì²´ ìš”ì•½

### êµ¬í˜„ëœ ì‹œìŠ¤í…œ (ëª¨ë‘ ì™„ë£Œ âœ…)

**1. ì»¤ë§¨ë“œ ì‹œìŠ¤í…œ**
- âœ… 62ê°œ ëª¨ë“  ì»¤ë§¨ë“œ í•¸ë“¤ëŸ¬
- âœ… í„´ì œ/ì‹¤ì‹œê°„ í†µí•© (ZSET ê¸°ë°˜)
- âœ… ì¥ìˆ˜ë³„ í ì‹œìŠ¤í…œ (FIFO ë³´ì¥)
- âœ… CommandProcessor, CommandCompleter

**2. ì „íˆ¬ ì‹œìŠ¤í…œ**
- âœ… 40x40 ê²©ì ì „íˆ¬
- âœ… ì˜ˆì•½ ëª¨ë¸ (crew_reserved, êµì°© ë°©ì§€)
- âœ… BattleEngine (í‹±/ë¼ìš´ë“œ)
- âœ… Lua ìŠ¤í¬ë¦½íŠ¸ (ì›ìì  ì²˜ë¦¬)
- âœ… ì¥ìˆ˜/ë³‘ë ¥ ì‚¬ë§ ì²˜ë¦¬

**3. ì›¹ì†Œì¼“ ì‹œìŠ¤í…œ**
- âœ… Socket.IO ì„œë²„
- âœ… Redis Pub/Sub ì—°ë™
- âœ… ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ í‘¸ì‹œ
- âœ… Room ê´€ë¦¬ (session, battle, entityë³„)

**4. Lore ì¤‘ë¦½ Entity ì‹œìŠ¤í…œ**
- âœ… 14ê°œ Role (SETTLEMENT, COMMANDER, FACTION, ITEM, AUCTION, POST, VOTE ë“±)
- âœ… ì™„ì „ ë™ì  ëª¨ë¸ (attributes, slots, resources, refs, systems)
- âœ… Edge ì»¬ë ‰ì…˜ (ê·¸ë˜í”„ ê´€ê³„)
- âœ… EntityRepository (í†µí•© ì €ì¥ì†Œ)

**5. ì‹œìŠ¤í…œ í”ŒëŸ¬ê·¸ì¸ ì•„í‚¤í…ì²˜**
- âœ… GameSystem ì¸í„°í˜ì´ìŠ¤
- âœ… SystemEngine (ì‹¤í–‰ ì—”ì§„)
- âœ… ì‹œë‚˜ë¦¬ì˜¤ë³„ ì‹œìŠ¤í…œ ë“±ë¡

**6. ìì› ì‹œìŠ¤í…œ**
- âœ… ResourceRegistry (ì‹œë‚˜ë¦¬ì˜¤ë³„ ìì› ì •ì˜)
- âœ… ResourceService (ë™ì  ìì› ê²€ì¦/ì†Œë¹„/ë³€í™˜)
- âœ… ìì› ë³€í™˜ ê·œì¹™

**7. ì‹œë‚˜ë¦¬ì˜¤ ì‹œìŠ¤í…œ**
- âœ… ScenarioRegistry (ì—­í• /ê´€ê³„/ì†ì„±/ìŠ¬ë¡¯/ì‹œìŠ¤í…œ ë§¤í•‘)
- âœ… ì‚¼êµ­ì§€ ì™„ì „ ë“±ë¡
- âœ… SF ì˜ˆì‹œ ë“±ë¡

**8. í†µí•© API**
- âœ… v2 API (/v2/settlements, /v2/commanders ë“±)
- âœ… í†µí•© Entity API (/api/entities/:role)
- âœ… ì‹œìŠ¤í…œ ì»¤ë§¨ë“œ API (/api/entities/:role/:id/systems/:systemId)

**9. í´ë” êµ¬ì¡° ì¤‘ë¦½í™”**
- âœ… general â†’ commander
- âœ… city â†’ settlement
- âœ… nation â†’ faction
- âœ… ëª¨ë“  í•˜ìœ„ í´ë” í¬í•¨

**10. ë¬¸ì„œ**
- âœ… SCENARIO_GUIDE.md
- âœ… API_STRUCTURE.md
- âœ… ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸

## ğŸ“ ìµœì¢… ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          í´ë¼ì´ì–¸íŠ¸ (Frontend)               â”‚
â”‚  React/Vue + Socket.IO Client               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              API Layer                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ REST API     â”‚  â”‚ WebSocket    â”‚        â”‚
â”‚  â”‚ /api/entitiesâ”‚  â”‚ Socket.IO    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Business Logic Layer                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  SystemEngine                    â”‚       â”‚
â”‚  â”‚  - AuctionSystem                 â”‚       â”‚
â”‚  â”‚  - BettingSystem                 â”‚       â”‚
â”‚  â”‚  - RankingSystem                 â”‚       â”‚
â”‚  â”‚  - HistorySystem                 â”‚       â”‚
â”‚  â”‚  - Economy/Diplomacy/Warfare     â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  CommandProcessor                â”‚       â”‚
â”‚  â”‚  - 62 Handlers                   â”‚       â”‚
â”‚  â”‚  - FIFO Queue                    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  BattleEngine                    â”‚       â”‚
â”‚  â”‚  - Tick/Round                    â”‚       â”‚
â”‚  â”‚  - Combat Logic                  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Data Layer                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ MongoDB    â”‚  â”‚ Redis        â”‚          â”‚
â”‚  â”‚ entities   â”‚  â”‚ Cache        â”‚          â”‚
â”‚  â”‚ edges      â”‚  â”‚ Queue        â”‚          â”‚
â”‚  â”‚ system_    â”‚  â”‚ ZSET         â”‚          â”‚
â”‚  â”‚   states   â”‚  â”‚ Pub/Sub      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ 14ê°œ Role ìƒì„¸

| Role | ìš©ë„ | ì˜ˆì‹œ |
|------|------|------|
| SETTLEMENT | ê±°ì  | ë„ì‹œ/í–‰ì„±/ë§ˆì„ |
| COMMANDER | ì§€íœ˜ê´€ | ì¥ìˆ˜/ì˜ì›…/ì»¤ë§¨ë” |
| FACTION | ì„¸ë ¥ | êµ­ê°€/ì™•êµ­/ì§„ì˜ |
| FORCE | ì „íˆ¬ë¶€ëŒ€ | ë¶€ëŒ€/í•¨ëŒ€/êµ°ë‹¨ |
| DIPLOMACY | ì™¸êµê´€ê³„ | ë™ë§¹/ì „ìŸ |
| ITEM | ì•„ì´í…œ | ë¬´ê¸°/ë°©ì–´êµ¬/ì†Œëª¨í’ˆ |
| AUCTION | ê²½ë§¤ | ì•„ì´í…œ ê²½ë§¤ |
| BID | ì…ì°° | ê²½ë§¤ ì…ì°° |
| POST | ê²Œì‹œê¸€ | board/message/comment |
| VOTE | íˆ¬í‘œ | ì¢‹ì•„ìš”/ë°˜ëŒ€/ì´ëª¨ì§€ |
| USER | ìœ ì € | í”Œë ˆì´ì–´ ê³„ì • |
| LOG_ENTRY | ë¡œê·¸ | íˆìŠ¤í† ë¦¬/ì ‘ì†ê¸°ë¡/ì´ë²¤íŠ¸ |
| RESERVATION | ì˜ˆì•½ | ì‹œê°„ì œ ì˜ˆì•½ |
| NPC_POOL | NPCí’€ | NPC ì„ íƒ í’€ |

## ğŸ“ í´ë” ì •ë¦¬ ê²°ê³¼

### í†µí•© ì™„ë£Œ
- 39ê°œ í´ë” â†’ 14ê°œ Role + ì‹œìŠ¤í…œ
- ëª¨ë“  ê¸°ëŠ¥ ìœ ì§€
- ê¹”ë”í•œ êµ¬ì¡°

### src/api ìµœì¢… êµ¬ì¡°
```
src/api/
â”œâ”€â”€ @types/              ê³µí†µ íƒ€ì…
â”œâ”€â”€ common/              ê³µí†µ ìœ í‹¸
â”œâ”€â”€ unified/             í†µí•© Entity API â­ ì‹ ê·œ
â”œâ”€â”€ v2/                  v2 API
â”œâ”€â”€ command/             ì»¤ë§¨ë“œ ì‹œìŠ¤í…œ
â”œâ”€â”€ battle/              ì „íˆ¬ ì‹œìŠ¤í…œ
â”œâ”€â”€ daemon/              ë°±ê·¸ë¼ìš´ë“œ ì›Œì»¤
â”œâ”€â”€ websocket/           ì›¹ì†Œì¼“
â”œâ”€â”€ admin/               ì–´ë“œë¯¼
â”œâ”€â”€ config/              ì„¤ì •
â””â”€â”€ index.ts
```

## ğŸš€ ì‚¬ìš© ì˜ˆì‹œ

### ìƒˆ ì‹œë‚˜ë¦¬ì˜¤ ì¶”ê°€ (5ë¶„)
```typescript
ScenarioRegistry.register('fantasy', {
  resources: [
    { id: 'mana', kind: 'energy', label: { ko: 'ë§ˆë‚˜' } }
  ],
  attributes: {
    COMMANDER: [
      { id: 'magic_power', label: { ko: 'ë§ˆë ¥' }, max: 100 }
    ]
  },
  systems: {
    magic: MagicSystem
  }
});
```

### ìƒˆ ê¸°ëŠ¥ ì¶”ê°€ (í”ŒëŸ¬ê·¸ì¸)
```typescript
const QuestSystem: GameSystem = {
  id: 'quest',
  scope: 'entity',
  reducers: {
    ACCEPT_QUEST: async (ctx, { questId }) => { ... },
    COMPLETE_QUEST: async (ctx, { questId }) => { ... }
  }
};
```

### API ì‚¬ìš©
```http
# ëª¨ë“  ì‹œë‚˜ë¦¬ì˜¤ì— ë™ì¼
GET /api/entities/COMMANDER?scenario=sangokushi
GET /api/entities/COMMANDER?scenario=fantasy
GET /api/entities/ITEM?scenario=sf

# ì‹œìŠ¤í…œ ì»¤ë§¨ë“œ
POST /api/entities/COMMANDER/hero_001/systems/magic/commands/CAST_SPELL
POST /api/entities/AUCTION/auction_001/systems/auction/commands/PLACE_BID
```

## ğŸ“Š í†µê³„

- **ì»¤ë§¨ë“œ í•¸ë“¤ëŸ¬**: 62ê°œ
- **Role**: 14ê°œ
- **ìƒì„±ëœ íŒŒì¼**: 50+ ê°œ
- **ë¬¸ì„œ**: 4ê°œ
- **TypeScript ì˜¤ë¥˜**: 0ê°œ âœ…

## ğŸ† ê²°ë¡ 

**ì™„ë²½í•œ ë²”ìš© ê²Œì„ ì—”ì§„ ì™„ì„±**
- ì–´ë–¤ ì¥ë¥´ë“  ì§€ì› (ì‚¼êµ­ì§€, íŒíƒ€ì§€, SF, RPG, ì „ëµ ë“±)
- ëª¨ë“  ê¸°ëŠ¥ í”ŒëŸ¬ê·¸ì¸í™”
- ì™„ì „ Lore ì¤‘ë¦½
- ë¬´í•œ í™•ì¥ ê°€ëŠ¥

ğŸ®âœ¨ğŸš€
