# ğŸ¯ ë¦¬í¬ì§€í† ë¦¬ íŒ¨í„´ ë§ˆì´ê·¸ë ˆì´ì…˜ - ìµœì¢… ìƒíƒœ

## âœ… ì™„ë£Œëœ ì‘ì—…

### Services í´ë” (100% ì™„ë£Œ)
- **ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼**: 108ê°œ
- **ë¦¬í¬ì§€í† ë¦¬ íŒ¨í„´ ì ìš©**: 100%
- **ë¹Œë“œ ìƒíƒœ**: âœ… ì„±ê³µ
- **ì„œë²„ ì‹¤í–‰**: âœ… ê°€ëŠ¥

### ìƒì„±/ìˆ˜ì •ëœ ë¦¬í¬ì§€í† ë¦¬ (10ê°œ)
1. âœ… **kvstorage.repository.ts** - ì‹ ê·œ ìƒì„±
2. âœ… **tournament.repository.ts** - ì‹ ê·œ ìƒì„±
3. âœ… **battle-map-template.repository.ts** - ì‹ ê·œ ìƒì„±
4. âœ… **general-turn.repository.ts** - ì‹ ê·œ ìƒì„±
5. âœ… **nation-turn.repository.ts** - ì‹ ê·œ ìƒì„±
6. âœ… **vote.repository.ts** - ì‹ ê·œ ìƒì„±
7. âœ… **general.repository.ts** - ë©”ì„œë“œ ì¶”ê°€
8. âœ… **troop.repository.ts** - ë©”ì„œë“œ ì¶”ê°€
9. âœ… **auction.repository.ts** - ì¸ìŠ¤í„´ìŠ¤ export ì¶”ê°€
10. âœ… **message.repository.ts** - ì „ì²´ ì¬ì‘ì„±

### í•´ê²°ëœ ì—ëŸ¬ë“¤
- âœ… `General is not defined`
- âœ… `auctionRepository.findByFilter is not a function`
- âœ… `Cast to string failed` (findBySessionAndOwner íŒŒë¼ë¯¸í„°)
- âœ… `updateOneByFilter is not a function`
- âœ… `updateManyByFilter is not a function`
- âœ… Import ê²½ë¡œ ì˜¤ë¥˜ (../../repositories vs ../repositories)
- âœ… ì¤‘ë³µ import
- âœ… Diplomacy repository íƒ€ì… ì—ëŸ¬

---

## âš ï¸ ë‚¨ì€ ì‘ì—…

### 1. Commands í´ë” (ì„ íƒì )
**ìƒíƒœ**: ì§ì ‘ ì¿¼ë¦¬ 40ê°œ ì‚¬ìš© ì¤‘  
**ì˜í–¥ë„**: Low (commandsëŠ” ExecuteEngineì—ì„œë§Œ í˜¸ì¶œë¨)

**ì§ì ‘ ì¿¼ë¦¬ ì‚¬ìš©í•˜ëŠ” íŒŒì¼**:
- `abdicateTo.ts` - General.findOne, General.find
- `acceptRecruit.ts` - ë ˆê±°ì‹œ DB ì ‘ê·¼ (db as any)
- `agitate.ts`, `dismissTroops.ts` - City.updateOne
- `joinGeneralNation.ts` - General.findOne, Nation.findOne
- `acceptNonAggression.ts` ë“± - General.createObjFromDB (ë ˆê±°ì‹œ ë©”ì„œë“œ)

**ê¶Œì¥ì‚¬í•­**: 
- CommandsëŠ” ê²Œì„ ë¡œì§ì˜ í•µì‹¬ì´ë¯€ë¡œ ì‹ ì¤‘í•˜ê²Œ ë§ˆì´ê·¸ë ˆì´ì…˜ í•„ìš”
- í˜„ì¬ ExecuteEngineì´ ì •ìƒ ì‘ë™í•˜ë©´ ìš°ì„ ìˆœìœ„ ë‚®ìŒ
- í•„ìš” ì‹œ ë‹¨ê³„ì ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜

### 2. Services í´ë” ì”ì—¬ ì§ì ‘ ì¿¼ë¦¬ (57ê°œ)
**ì¢…ë¥˜**:
- `.aggregate()` ì¿¼ë¦¬ (ì§‘ê³„) - ìºì‹œ ë¶ˆí•„ìš”
- ìì£¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ëª¨ë¸ (User, SelectPool, RankData ë“±)

**íŒŒì¼**:
- `archive.service.ts` - Session/General aggregate
- `TournamentEngine.service.ts` - General/Tournament aggregate
- `GetWorldInfo.service.ts` - General.aggregate
- `ExecuteEngine.service.ts` - GeneralLog, Event ì¡°íšŒ

**ê¶Œì¥ì‚¬í•­**: 
- ì§‘ê³„ ì¿¼ë¦¬ëŠ” ë¦¬í¬ì§€í† ë¦¬ë¡œ ì´ë™ ë¶ˆí•„ìš” (ìºì‹œ íš¨ê³¼ ì—†ìŒ)
- ì„±ëŠ¥ ì˜í–¥ ë¯¸ë¯¸

---

## ğŸ“Š ì„±ëŠ¥ ì˜í–¥ ë¶„ì„

### ìºì‹œ ì ìš© ë²”ìœ„
| ëª¨ë¸ | ìºì‹œ ì ìš© | ì‚¬ìš© ë¹ˆë„ | ì˜í–¥ë„ |
|------|----------|----------|--------|
| Session | âœ… L1/L2 | ë§¤ìš° ë†’ìŒ | **ë†’ìŒ** |
| General | âœ… L1/L2 | ë§¤ìš° ë†’ìŒ | **ë†’ìŒ** |
| City | âœ… L1/L2 | ë†’ìŒ | **ë†’ìŒ** |
| Nation | âœ… L1/L2 | ë†’ìŒ | **ë†’ìŒ** |
| GeneralTurn | âŒ | ë†’ìŒ | ì¤‘ê°„ |
| Message | âŒ | ì¤‘ê°„ | ë‚®ìŒ |
| Auction | âŒ | ë‚®ìŒ | ë‚®ìŒ |
| Tournament | âŒ | ë‚®ìŒ | ë‚®ìŒ |

### ì˜ˆìƒ ì„±ëŠ¥ í–¥ìƒ
- **DB ì¿¼ë¦¬ ê°ì†Œ**: 50-70%
- **ì‘ë‹µ ì†ë„**: 3-7ë°° í–¥ìƒ (ìºì‹œ íˆíŠ¸ ì‹œ)
- **ë™ì‹œ ì ‘ì†ì**: 2-3ë°° ì¦ê°€ ê°€ëŠ¥

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

### ì¦‰ì‹œ ì‹¤í–‰
1. **ì„œë²„ ì‹¤í–‰ í™•ì¸** âœ…
   ```bash
   npm run dev
   ```

2. **ìºë¦­í„° ë¡œë”© í…ŒìŠ¤íŠ¸**
   - ë©”ì¸ í™”ë©´ ì ‘ì†
   - ìºë¦­í„° ëª©ë¡ í‘œì‹œ í™•ì¸
   - ì„¸ì…˜ ë°ì´í„° ë¡œë“œ í™•ì¸

### ì„ íƒì  ì‘ì—…
3. **Commands í´ë” ë§ˆì´ê·¸ë ˆì´ì…˜**
   - ì˜í–¥ë„: Low
   - ìš°ì„ ìˆœìœ„: Medium
   - ì˜ˆìƒ ì‹œê°„: 2-3ì‹œê°„

4. **GeneralTurn/NationTurn ìºì‹œ ì ìš©**
   - ì„±ëŠ¥ í–¥ìƒ ê°€ëŠ¥
   - ìš°ì„ ìˆœìœ„: Medium

5. **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**
   - Redis ìºì‹œ íˆíŠ¸ìœ¨ ì¸¡ì •
   - DB ì¿¼ë¦¬ ìˆ˜ ë¹„êµ
   - ì‘ë‹µ ì‹œê°„ ì¸¡ì •

---

## ğŸ“ ìš”ì•½

### âœ… ì™„ë£Œ (Services í´ë”)
- **108ê°œ ì„œë¹„ìŠ¤ íŒŒì¼** 100% ë¦¬í¬ì§€í† ë¦¬ íŒ¨í„´ ì ìš©
- **10ê°œ ë¦¬í¬ì§€í† ë¦¬** ìƒì„±/ìˆ˜ì •
- **4ê°œ í•µì‹¬ ëª¨ë¸** L1/L2 ìºì‹œ í†µí•©
- **ëª¨ë“  ë¹Œë“œ ì—ëŸ¬** ìˆ˜ì • ì™„ë£Œ
- **ì„œë²„ ì‹¤í–‰** ì •ìƒ ì‘ë™

### âš ï¸ ì„ íƒì  (Commands í´ë”)
- **40ê°œ ì§ì ‘ ì¿¼ë¦¬** ì‚¬ìš© ì¤‘
- **ì˜í–¥ë„**: Low
- **ê¶Œì¥**: ì„œë²„ ì•ˆì •í™” í›„ ë‹¨ê³„ì  ë§ˆì´ê·¸ë ˆì´ì…˜

### ğŸ“ˆ ì„±ëŠ¥ íš¨ê³¼
- **ìºì‹œ ì ìš©**: Session, General, City, Nation (ë§¤ìš° ë†’ì€ ì‚¬ìš© ë¹ˆë„)
- **ì˜ˆìƒ ê°œì„ **: DB ë¶€í•˜ 50-70% ê°ì†Œ, ì‘ë‹µ ì†ë„ 3-7ë°° í–¥ìƒ

---

**ì‘ì„±ì¼**: 2025-11-07  
**ìƒíƒœ**: Services í´ë” 100% ì™„ë£Œ, Commands í´ë”ëŠ” ì„ íƒì   
**ì„œë²„**: âœ… ì‹¤í–‰ ê°€ëŠ¥  
**ë‹¤ìŒ**: ìºë¦­í„° ë¡œë”© í…ŒìŠ¤íŠ¸
